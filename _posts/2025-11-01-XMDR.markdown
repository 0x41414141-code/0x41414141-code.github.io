---

layout: post
title: "Huntress CTF 2025 - XMDR"
categories: writeup misc 
permalink: :categories/:title

---


## Challenge Description

>We had a lot of fun helping the Internet understand what MDRs are, but we thought of the>next the best thing:  
  **why not have you _use one!_** ðŸ˜„

>A host that you protect had some strange alerts fire off... can you analyze and triage to find other malicious activity?

Provided IP: `10.1.182.225`

---

After accessing the site we see this:

[![](_site/assets/alerts.png)](_site/assets/alerts.png)

We can download the zip file.

After looking through the GTRS folder we notice that is the Google Translate Reverse Shell

I searched where are browser histories stored in windows system(for Google):
`C:\Users\Administrator\AppData\Local\Google\Chrome\User Data\Default\History`

We don't see the extension, so what kind of file is it?

```
History: SQLite 3.x database, last written using SQLite version 3050000, file counter 19, database pages 77, cookie 0x21  
, schema 4, UTF-8, version-valid-for 19
```

after extracting link and URL decoding them I find these:

```
https://translate.google.com/?sl=auto&tl=en&text=STARTCOMMAND  
begin 664 -  
,=&%S:VQI<W0@+W8*  
`  
end  
ENDCOMMAND  
&op=translate
```

I went to the dcode.fr for their cipher identifier and it said it is UUencoded

So I wrote a a script to url decode history links and to extract just the part between the 
`begin 664 -` and `end`

### Python

```python
import sqlite3  
import os  
from datetime import datetime, timedelta  
from urllib.parse import unquote  
import re  
  
def extract_chrome_history(history_path):  
Â Â Â # Chrome locks the history file, so we need to copy it  
Â Â Â import shutil  
Â Â Â temp_db = "temp_chrome_history.db"  
Â Â Â shutil.copy2(history_path, temp_db)  
Â Â Â Â   
Â Â Â conn = sqlite3.connect(temp_db)  
Â Â Â cursor = conn.cursor()  
Â Â Â Â   
Â Â Â # Query to get browsing history  
Â Â Â cursor.execute("""  
Â Â Â Â Â Â Â SELECT Â   
Â Â Â Â Â Â Â Â Â Â Â urls.url, Â   
Â Â Â Â Â Â Â Â Â Â Â urls.title, Â   
Â Â Â Â Â Â Â Â Â Â Â urls.visit_count, Â   
Â Â Â Â Â Â Â Â Â Â Â urls.last_visit_time, Â   
Â Â Â Â Â Â Â Â Â Â Â visits.visit_time,  
Â Â Â Â Â Â Â Â Â Â Â visits.from_visit  
Â Â Â Â Â Â Â FROM urls Â   
Â Â Â Â Â Â Â LEFT JOIN visits ON urls.id = visits.url Â   
Â Â Â Â Â Â Â ORDER BY urls.last_visit_time DESC  
Â Â Â """)  
Â Â Â Â   
Â Â Â history = cursor.fetchall()  
Â Â Â Â   
Â Â Â print("=== Extracted Content from Chrome History ===")  
Â Â Â Â   
Â Â Â for entry in history[:50]: Â # Show first 50 entries  
Â Â Â Â Â Â Â url, title, visit_count, last_visit_time, visit_time, from_visit = entry  
Â Â Â Â Â Â Â Â   
Â Â Â Â Â Â Â # URL decode the URL and title  
Â Â Â Â Â Â Â decoded_url = unquote(url) if url else ""  
Â Â Â Â Â Â Â decoded_title = unquote(title) if title else ""  
Â Â Â Â Â Â Â Â   
Â Â Â Â Â Â Â # Extract content between "begin 664 -" and "end"  
Â Â Â Â Â Â Â begin_pattern = r"begin 664 -(.*?)end"  
Â Â Â Â Â Â Â matches = re.findall(begin_pattern, decoded_url, re.DOTALL)  
Â Â Â Â Â Â Â Â   
Â Â Â Â Â Â Â if matches:  
Â Â Â Â Â Â Â Â Â Â Â for match in matches:  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â extracted_content = match.strip()  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if extracted_content: Â # Only print if there's actual content  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â print("\n")  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â print(extracted_content)  
Â Â Â Â   
Â Â Â conn.close()  
Â Â Â os.remove(temp_db) Â # Clean up  
  
# Usage - replace with your actual path  
history_path = r"History"  
extract_chrome_history(history_path)
```

And then just going online to find UUEncode Decoder and we get the flag:

"L96-H;R!F;&%G>S8Y,C`P8S$S9&-B,SED93$Y830P-64Y9#%F.3DS.#(Q?0H`"

which when UUDecoded is:

`echo flag{69200c13dcb39de19a405e9d1f993821}`